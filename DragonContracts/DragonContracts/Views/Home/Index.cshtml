@{
    ViewBag.Title = "Home";
}
@section Scripts {
    @Scripts.Render("~/bundles/knockout")
    @Scripts.Render("~/bundles/jqueryval")

    <script type="text/javascript">
        function ContractsViewModel() {
            var self = this;
            self.loaded = ko.observable(false);
            self.contracts = ko.observableArray([]);

            self.createContactFromForm = function (formElement) {
                // If valid, post the serialized form data to the web api
                $(formElement).validate();
                if ($(formElement).valid()) {
                    $.post("/api/contracts", $(formElement).serialize(), "json")
                        .done(function (newContact) { self.contracts.push(newContact); });
                }
            }
            self.removeContact = function (contact) {
                // First remove from the server, then from the UI
                $.ajax({ type: "DELETE", url: contact.Self })
                    .done(function () { self.contracts.remove(contact); });
            }

            // Load the initial state
            $.getJSON("/api/contracts", self.contracts)
                .done(function() {
                     self.loaded(true);
                });
        }

        ko.applyBindings(new ContractsViewModel());
    </script>
}

<div id="body">
    <section class="featured">
        <div class="content-wrapper">
            <div>
                <button>Všechny typy</button>
                <button>Smlouvy o dílo</button>
                <button>Mandátní smlouvy</button>
                <button>Kupní smlouvy</button>
                <button>Nájemní smlouvy</button>
                <button>Ostatní smlouvy</button>
            </div>
        </div>
    </section>
    <section class="content-wrapper main-content clear-fix">
        <img id="loader" src="images/ajax-loader.gif" data-bind="visible: !loaded()" />


        <ul id="contracts" data-bind="visible: loaded, foreach: contracts"><!--  -->
            <li>
                <h1 data-bind="text: Subject" class="ui-widget-header"></h1>
                <div><span data-bind="text:Id"></span></div>
                <div><span data-bind="text: Price"></span></div>
                <div><span data-bind="text: SignedOn"></span></div>
                <!--<div><span data-bind="text: Address || 'Address?'"></span></div>-
                    <div>
                        <span data-bind="text: City || 'City?'"></span>,
                        <span data-bind="text: State || 'State?'"></span>
                        <span data-bind="text: Zip || 'Zip?'"></span>
                    </div>
                <div>
                    <a data-bind="visible: Email,
    text: Email,
    attr: { href: 'mailto:' + Email }"></a>
                    <span data-bind="visible: !Email">Email?</span>
                </div>
                <div>
                    <a data-bind="visible: Twitter,
    text: '@@' + Twitter,
    attr: { href: 'http://twitter.com/' + Twitter }"></a>
                    <span data-bind="visible: !$data.Twitter">Twitter?</span>
                </div>-->
                
            </li>
        </ul>
    </section>
</div>
